{% extends 'concert/base.html' %}
{% load staticfiles %}

{% block title %} {{ block.super }} {% endblock %}

{% block body_block %}

<style>
    .concert-image { 
        max-width: 100%;
        width : 100%;
        height: auto;
        max-height: 250px;
        object-fit: cover;

    }
</style>
<div class = "container">
    <h1 class="display-4">Discover</h1>
    <hr>
    <div class="row">
        {% for concert in concerts%}
            <div class="col-12 col-md-6 col-lg-4">
                <div class="card">
                    <img class="card-img-top concert-image" src="{{concert.image.url}}">

                    <div class="card-body">

                        <h5 class="card-title">{{ concert.artist }}</h5>
                        <span> 
                            <button class="btn btn-outline-dark" >View</button>
                            <button data = "{{ concert.concertID }}" class="btn btn-success bookmarkbutton"> Bookmark</button> 
                        </span>
                        <p class="card-text "><i>{{concert.description}}</i></p>

                    </div>
                </div>
            </div>
        {%endfor %}
    </div>
</div>

<script>

    var bookmarkButtons = document.querySelectorAll(".bookmarkbutton");

    bookmarkButtons.forEach(function(element) {
        element.addEventListener("click", bookmark);
    });

    function bookmark() {
            var concertid = (this).getAttribute('data');
            $.get('/concert/bookmark/', {concertid: concertid}); 
            toastr.success('Concert bookmarked!');

            var newElement = $(this).replaceWith('<button class="btn btn-outline-danger removebookmarkbutton" data="'+concertid+'">Remove Bookmark</button>');

            var removeBookmarkButtons = document.querySelectorAll(".removebookmarkbutton");

            removeBookmarkButtons.forEach(function(element) {
                    element.addEventListener("click", removebookmark);
            });


            //Start by bookmarking the concert
    };


    function removebookmark() {
            var concertid = (this).getAttribute('data');
            $.get('/concert/removebookmark/', {concertid: concertid});
            toastr.error('Bookmark removed!');

            $(this).replaceWith('<button class="btn btn-success bookmarkbutton" data = "'+concertid+'"> Bookmark</button> ');

            var bookmarkButtons = document.querySelectorAll(".bookmarkbutton");

            bookmarkButtons.forEach(function(element) {
                element.addEventListener("click", bookmark);
            });

    };

</script>

{% endblock %}
