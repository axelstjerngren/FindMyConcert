{% extends 'concert/base.html' %}
{% load staticfiles %}

{% block title %} {{ block.super }} {% endblock %}

{% block body_block %}
{% if user.is_authenticated %}
<div class="container">
   <h1>My Events</h1>

   <ul class="nav nav-tabs">
    <li class="nav-item">
       <a class="nav-link active" data-toggle="tab" href="#all" role="tab" aria-selected="true">All Events</a>
   </li>
    <li class="nav-item">
       <a class="nav-link" data-toggle="tab" href="#private" role="tab" aria-selected="true">My Upcoming Events</a>
   </li>

   <li class="nav-item">
       <a class="nav-link" data-toggle="tab" href="#venue" role="tab" aria-selected="true">My Past Events</a>
   </li>
</ul>

<div class="tab-content">
  <div id="all" class="tab-pane fade show active">
    {% if concerts %}
    <div class="table-responsive">
        <table class="table table-hover" align="center" style="width: 90%">
        <tbody>
            {% for concert in concerts %}
            <tr>
                <td>{{ concert.artist }}</td>
                <td>{{ concert.venue.venue_name }}, {{ concert.venue.location }}</td>
                <td>{{ concert.date }}</td>
                <td>{{ concert.start_time }} - {{ concert.end_time }}</td>
                <td>{{ concert.url }}</td>
                {% if user.is_authenticated and not user.is_venue %}
                <td><a href="{% url 'bookmark' concert.concertID%}">
                  <button class="button button-blue button-bordered">
                    <span class="button--inner">Bookmark</span>
                </button>
                </a></td>
                {% endif %}
            </tr>
             {% endfor %}
    </tbody>
</table>
</div>
{% else %}
<strong>There are currently no concerts with those search fields</strong>
{% endif %}
  </div>
  <div id="private" class="tab-pane fade show active">
    {% if user.is_venue %}
    {% if user.venue.concert %}
    <div class="table-responsive">
        <table class="table table-hover" align="center" style="width: 90%">
            <tbody>
                {% for concert in user.venue.concert.all %}
                {% if concert.is_future %}
                <tr>
                    <td>{{ concert.artist }}</td>
                    <td>{{ concert.venue.venue_name }} , {{ concert.venue.location }}</td>
                    <td>{{ concert.date }}</td>
                    <td>{{ concert.start_time }} - {{ concert.end_time }}</td>
                    <td>{{ concert.url }}</td>
                                        <td><a href="{% url 'edit' concert.concertID%}">
                  <button class="button button-blue button-bordered">
                    <span class="button--inner">Edit</span> </td>
                    <td>

                    <form action="{% url 'delete' concert.concertID%}" method="post">
                    {% csrf_token %}
                    <button type="submit" >Delete</button>
                    </form>
                    </div></td>


                </tr><
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <strong>You have no concerts, you can add one by pressing<span> <a href = "{% url 'add-concert' %}"> here </a> </span></strong>
    {% endif %}
    {% else %}

    {% if user.giggoer.bookmarks %}
    <div class="table-responsive">
        <table class="table table-hover" align="center" style="width: 90%">
            <tbody>
                {% for concert in user.giggoer.bookmarks.all %}
                {% if concert.is_future %}
                <tr>
                    <td>{{ concert.artist }}</td>
                    <td>{{ concert.venue.venue_name }} , {{ concert.venue.location }}</td>
                    <td>{{ concert.date }}</td>
                    <td>{{ concert.start_time }} - {{ concert.end_time }}</td>
                    <td>{{ concert.url }}</td>
                    <td><form action="{% url 'removebookmark' concert.concertID%}" method="post">
                    {% csrf_token %}
                    <button type="submit" >Remove Bookmark</button>
                    </form>
                    </div></td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <strong>You have no concerts bookmarked</strong>
    {% endif %}
    {% endif %}

</div>

<div id="venue" class="tab-pane fade">
    {% if user.is_venue %}

      {% if user.venue.concert %}
      <div class="table-responsive">
        <table class="table table-hover" align="center" style="width: 90%">
            <tbody>
                {% for concert in user.venue.concert.all %}
                {% if not concert.is_future %}
                <tr>
                    <td>{{ concert.artist }}</td>
                    <td>{{ concert.venue.venue_name }} , {{ concert.venue.location }}</td>
                    <td>{{ concert.date }}</td>
                    <td>{{ concert.start_time }} - {{ concert.end_time }}</td>
                    <td>{{ concert.url }}</td>
                    <td><a href="{% url 'edit' concert.concertID%}">
                  <button class="button button-blue button-bordered">
                    <span class="button--inner">Edit</span></td>

                    <td><form action="{% url 'delete' concert.concertID%}" method="post">
                    {% csrf_token %}
                    <button type="submit" >Delete</button>
                    </form>
                    </div></td>

                
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
      </div>

    {% else %}
    <strong>You have no concerts, you can add one by pressing<span> <a href = "{% url 'add-concert' %}"> here </a> </span></strong>
    {% endif %}
    {% else %}
        {% if user.giggoer.bookmarks %}
    <div class="table-responsive">
        <table class="table table-hover" align="center" style="width: 90%">
            <tbody>
                {% for concert in user.giggoer.bookmarks.all %}
                {% if not concert.is_future %}
                <tr>
                    <td>{{ concert.artist }}</td>
                    <td>{{ concert.venue.venue_name }} , {{ concert.venue.location }}</td>
                    <td>{{ concert.date }}</td>
                    <td>{{ concert.start_time }} - {{ concert.end_time }}</td>
                    <td>{{ concert.url }}</td>
                    <td><form action="{% url 'removebookmark' concert.concertID%}" method="post">
                    {% csrf_token %}
                    <button type="submit" >Remove Bookmark</button>
                    </form>
                    </div></td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <strong>You have no concerts bookmarked</strong>
    {% endif %}
    {% endif %}
</div>
</div>
</div>
{% else %}
{% if concerts %}
<div class="table-responsive">
    <table class="table table-hover" align="center" style="width: 90%">
        <tbody>
            {% for concert in concerts %}
            <tr>
                <td>{{ concert.artist }}</td>
                <td>{{ concert.venue.venue_name }}, {{ concert.venue.location }}</td>
                <td>{{ concert.date }}</td>
                <td>{{ concert.start_time }} - {{ concert.end_time }}</td>
                <td>{{ concert.url }}</td>
                {% if user.is_authenticated and not user.is_venue %}
                <td><a href="{% url 'bookmark' concert.concertID%}">
                  <button class="button button-blue button-bordered">
                    <span class="button--inner">Bookmark</span>
                </button>
                </a></td>
                {% endif %}
            </tr>
             {% endfor %}
    </tbody>
</table>
</div>
{% else %}
<strong>There are currently no concerts with those search fields</strong>
{% endif %}

{% if location %}
Your current city: {{ location.city }}
{% endif %}

{% endif %}
{% endblock %}